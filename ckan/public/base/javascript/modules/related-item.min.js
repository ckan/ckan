this.ckan.module('related-item',function(jQuery,_){return{options:{truncate:55,truncateMore:null,truncateLess:null,truncatePrefix:'',truncateSuffix:'',truncateSelector:'.prose',expandedClass:'expanded',hasExpanderClass:'is-expander',i18n:{more:_('show more'),less:_('show less')}},initialize:function(){jQuery.proxyAll(this,/_on/);var options=this.options;this.description=this.$(options.truncateSelector);this.truncated=this.description.truncate({max_length:options.truncate,more:options.truncateMore||this.i18n('more'),less:options.truncateLess||this.i18n('less'),link_prefix:options.truncatePrefix,link_suffix:options.truncateSuffix});this.collapsedHeight=this.el.height();this.truncated.on('expand.truncate',this._onExpand);this.truncated.on('collapse.truncate',this._onCollapse);if($('.truncator-link',this.description).length>0){this.el.addClass(options.hasExpanderClass);}},_onExpand:function(){var diff=this.el.height()-this.collapsedHeight;this.el.addClass(this.options.expandedClass);this.el.css('margin-bottom',diff*-1);},_onCollapse:function(){this.el.removeClass(this.options.expandedClass);this.el.css('margin-bottom','');}};});