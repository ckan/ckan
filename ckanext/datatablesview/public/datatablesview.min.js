var run_query=function(a,n){var t=$("#filtered-datatables-download"),e=$('<input name="params" type="hidden"/>');e.attr("value",JSON.stringify(a)),t.append(e);var r=$('<input name="format" type="hidden"/>');r.attr("value",n),t.append(r),t.submit()},ga_event_tracking=function(){var a=encodeURIComponent(window.location);if(a){var n=jQuery(location).prop("pathname").split("/");n&&ga("send",{hitType:"event",eventCategory:"resource",eventAction:"download",eventLabel:a,dimension1:n[jQuery.inArray("resource",n)+1],dimension2:n[jQuery.inArray("dataset",n)+1]})}};this.ckan.module("datatables_view",(function(a){return{initialize:function(){let n={};"fr"===this.options.lang&&(n={url:"//cdn.datatables.net/plug-ins/1.11.3/i18n/fr_fr.json"});a("#dtprv").DataTable({initComplete:function(n,t){let e=a("#dtprv_wrapper"),r=a(e).find("#dtprv_processing");r.length>0&&r.css({"z-index":"2"});let i=a(e).find("#dtprv").DataTable();i.button().add(2,{text:ckan.i18n._("Download"),extend:"collection",buttons:[{text:"CSV",className:"resource-url-analytics",attr:{"data-gc-analytics":"manualDownload"},action:function(a,n,t,e){var r=i.ajax.params();r.visible=i.columns().visible().toArray(),run_query(r,"csv"),ga_event_tracking()}},{text:"TSV",className:"resource-url-analytics",attr:{"data-gc-analytics":"manualDownload"},action:function(a,n,t,e){var r=i.ajax.params();r.visible=i.columns().visible().toArray(),run_query(r,"tsv"),ga_event_tracking()}},{text:"JSON",className:"resource-url-analytics",attr:{"data-gc-analytics":"manualDownload"},action:function(a,n,t,e){var r=i.ajax.params();r.visible=i.columns().visible().toArray(),run_query(r,"json"),ga_event_tracking()}},{text:"XML",className:"resource-url-analytics",attr:{"data-gc-analytics":"manualDownload"},action:function(a,n,t,e){var r=i.ajax.params();r.visible=i.columns().visible().toArray(),run_query(r,"xml"),ga_event_tracking()}}]})},drawCallback:function(n){let t=a("#dtprv_wrapper"),e=a(t).find("#dtprv_processing");e.length>0&&e.css({display:"none","z-index":"2"})},language:n})}}}));
