{% extends "base.html" %}

{% block page %}
  <table id="dtprv"
      class="table table-striped table-bordered"
      data-role="table"
      data-mode="columntoggle" >
    <thead>
      <tr>
        {% for field in [{'id': '_id'}] + h.datastore_dictionary(resource.id) %}
          {% if 'show_fields' not in resource_view
            or field.id in resource_view.show_fields %}
            <th scope="col">{{ field.id }}</th>
          {% endif %}
        {% endfor %}
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>
{% endblock %}

{% block scripts %}
<script
  src="https://code.jquery.com/jquery-2.2.4.min.js"
  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
  crossorigin="anonymous"></script>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs-3.3.7/jq-2.2.4/jszip-2.5.0/dt-1.10.13/b-1.2.4/b-colvis-1.2.4/b-flash-1.2.4/b-html5-1.2.4/b-print-1.2.4/fc-3.2.2/fh-3.1.2/kt-2.2.0/r-2.1.1/se-1.2.0/datatables.min.css"/>
 <script type="text/javascript" src="https://cdn.datatables.net/v/bs-3.3.7/jq-2.2.4/jszip-2.5.0/dt-1.10.13/b-1.2.4/b-colvis-1.2.4/b-flash-1.2.4/b-html5-1.2.4/b-print-1.2.4/fc-3.2.2/fh-3.1.2/kt-2.2.0/r-2.1.1/se-1.2.0/datatables.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  $('#dtprv').DataTable(
    {
      paging: true,
      serverSide: true,
      processing: true,
      ajax: {
        url: "/datatables/ajax/{{ resource_view.id }}",
        type: "POST",
        data: { filters: "{{ request.params.get('filters', '')|e }}" }
      },
      responsive: {{
        'true' if resource_view.get('responsive') else 'false' }},
      fixedHeader: true,
      fixedColumns: true,
      scrollX: {{
        'false' if resource_view.get('responsive') else 'true' }},
      dom: 'Blifrtip',
      buttons: [
        {
          extend: 'colvis',
          text: '{{ _('Hide/Unhide Columns') }}',
        }{{ ", 'copy', 'excel', 'print'" | safe
          if resource_view.get('export_buttons') else ''}}
      ],
      keys: true
    }
  );
});
</script>
{% endblock %}

{% block styles %}{% endblock %}
{% block custom_styles %}{% endblock %}
